<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>6. Fractals &#8212; Djalgo 0.1-alpha documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script src="_static/documentation_options.js?v=737112c1"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="7. Genetic algorithms" href="07_genetic.html" />
    <link rel="prev" title="5. Walks" href="05_walks.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="6.-Fractals">
<h1>6. Fractals<a class="headerlink" href="#6.-Fractals" title="Link to this heading">¶</a></h1>
<p>Walks does offer an internal structure unless we force them to pass through predefined points with fitted kernels. Fractals are mathematical sets that exhibit a repeating pattern at every scale. They have not only captivated mathematicians and scientists, but have also found a fascinating application in the world of music. The concept of fractals in music revolves around the idea of using these self-similar patterns to create compositions that can vary in complexity, embodying both a sense of
infinity and a coherent structure. This approach to music composition allows for the exploration of new textures, forms, and sonic landscapes, pushing the boundaries of traditional musical creativity. Fractals inspired modern composers Jessie Montgomery in <a class="reference external" href="https://www.youtube.com/watch?v=eMYG_w6ueUg">Rounds for Piano and Orchestra</a> and Dinuk Wijeratne in <a class="reference external" href="https://www.youtube.com/watch?v=sAK8aqAdUCA&amp;t=1424s">Invisible cities</a>. Djalgo has four types of fractals: <strong>cellular automata</strong>
(self-organizing systems governed by simple rules in a discrete grid), <strong>Mandelbrot</strong> (complex and infinitely detailed fractal structure), and <strong>logistic map</strong> (a simple mathematical model illustrating chaos theory).</p>
<section id="Cellular-automata">
<h2>Cellular automata<a class="headerlink" href="#Cellular-automata" title="Link to this heading">¶</a></h2>
<p>Genius composer Iannis Xenakis might have been the first to popularize (or even to use) cellular automata in music with his orchestral work <a class="reference external" href="https://www.youtube.com/watch?v=9aYsh8SRB-c">Horos</a> in 1986 (<a class="reference external" href="https://hal.science/hal-00770141">Solomos, 2013</a>). This section applies a rather simple method to compose music with cellular automata, and can be summarized in three steps.</p>
<ol class="arabic simple">
<li><p>Select a rule (among the 256 presented in the <a class="reference external" href="http://atlas.wolfram.com/01/01/">Wolfram atlas</a>) and the initial state, then draw the cells.</p></li>
<li><p>Select a strip along the sequence dimension.</p></li>
<li><p>Apply notes and durations to transform the strip to a <a class="reference external" href="https://en.wikipedia.org/wiki/Piano_roll#In_digital_audio_workstations">digital piano roll</a>.</p></li>
</ol>
<p>These steps are shown in this 1 minute 13 seconds video. The music played in this video is the one we will compose here.</p>
<div style="padding:56.25% 0 0 0;position:relative;"><iframe src="https://player.vimeo.com/video/791484908?h=8ed8a123a2&amp;badge=0&amp;autopause=0&amp;player_id=0&amp;app_id=58479/embed" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen frameborder="0" style="position:absolute;top:0;left:0;width:100%;height:100%;"></iframe></div><p>You can create an interesting score by hand, but inductively trying all sorts of scores, or complexifying the process by hand can be labourious. This is where Djalgo can help.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">djalgo</span> <span class="k">as</span> <span class="nn">dj</span>
</pre></div>
</div>
</div>
<p>We can start by plotting few cellular automata rules with a single cell initiating the pattern at the center of the first sequence.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># our plotting library</span>

<span class="n">width</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">iterations</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">initial_state</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">width</span>
<span class="n">initial_state</span><span class="p">[</span><span class="n">width</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">rules</span> <span class="o">=</span> <span class="p">[</span><span class="mi">18</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">150</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>  <span class="c1"># Adjust the size and layout as needed</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">rule</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rules</span><span class="p">):</span>
    <span class="n">ca</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">fractal</span><span class="o">.</span><span class="n">CellularAutomata</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">initial_state</span><span class="p">)</span>
    <span class="n">ca</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">iterations</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Rule &#39;</span><span class="o">+</span> <span class="n">ca</span><span class="o">.</span><span class="n">rule_number</span><span class="p">,</span> <span class="n">show_axis</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Pass the specific subplot axis</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/06_fractals_4_0.png" class="no-scaled-link" src="_images/06_fractals_4_0.png" style="width: 700px; height: 503px;" />
</div>
</div>
<p>My written explaination video lasted 1:13, so I wanted a piece with a length a little below that. We will create three tracks for a traditional minimal rock band with an electric guitar, an electric bass and a drum kit.</p>
<section id="Steps-1-and-2.-Generate-cellular-automata-and-select-strips">
<h3>Steps 1 and 2. Generate cellular automata and select strips<a class="headerlink" href="#Steps-1-and-2.-Generate-cellular-automata-and-select-strips" title="Link to this heading">¶</a></h3>
<p>The first cellular automata will create piano rolls for the guitar and the bass. <a class="reference external" href="http://atlas.wolfram.com/01/01/150/">Rule 150</a> seemed appropriate. A width of 200 cells will provide a good overview of the cellular automata. I inductively chose 136 steps after few iterations to obtain a musical piece a bit shorter than 1:13. For sake of initial state, I just took a one in the middle.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate cells</span>
<span class="n">ca1_rule</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">width1</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">length1</span> <span class="o">=</span> <span class="mi">136</span>
<span class="n">init1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">width1</span>
<span class="n">init1</span><span class="p">[</span><span class="n">width1</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ca1</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">fractal</span><span class="o">.</span><span class="n">CellularAutomata</span><span class="p">(</span><span class="n">ca1_rule</span><span class="p">,</span> <span class="n">width1</span><span class="p">,</span> <span class="n">init1</span><span class="p">)</span>
<span class="n">ca1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">iterations</span><span class="o">=</span><span class="n">length1</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/06_fractals_7_0.png" class="no-scaled-link" src="_images/06_fractals_7_0.png" style="width: 494px; height: 700px;" />
</div>
</div>
<p>From this plot, I selected two strips: a guitar line playing all along the piece, and bass to jump in a little later.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ca1_rule</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">width1</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">length1</span> <span class="o">=</span> <span class="mi">136</span>
<span class="n">init1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">width1</span>
<span class="n">init1</span><span class="p">[</span><span class="n">width1</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ca1</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">fractal</span><span class="o">.</span><span class="n">CellularAutomata</span><span class="p">(</span><span class="n">ca1_rule</span><span class="p">,</span> <span class="n">width1</span><span class="p">,</span> <span class="n">init1</span><span class="p">)</span>
<span class="n">strips1</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">97</span><span class="p">,</span> <span class="mi">103</span><span class="p">),</span> <span class="p">(</span><span class="mi">85</span><span class="p">,</span> <span class="mi">92</span><span class="p">)]</span>
<span class="n">ca1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">iterations</span><span class="o">=</span><span class="n">length1</span><span class="p">,</span> <span class="n">strips</span><span class="o">=</span><span class="n">strips1</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/06_fractals_9_0.png" class="no-scaled-link" src="_images/06_fractals_9_0.png" style="width: 494px; height: 700px;" />
</div>
</div>
<p>The cellular automata process used for the guitar and the bass felt too dense with too much blank regions to generate good drumming. I tried a less dense rule set, with a random initial condition, then selected a region that allowed drums to kick in after a few beats in the piece.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>

<span class="n">ca2_rule</span> <span class="o">=</span> <span class="mi">18</span>
<span class="n">width2</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">length2</span> <span class="o">=</span> <span class="mi">136</span>
<span class="n">init2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">width2</span>
<span class="n">init2</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="n">width2</span><span class="p">)</span>
<span class="n">ca2</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">fractal</span><span class="o">.</span><span class="n">CellularAutomata</span><span class="p">(</span><span class="n">ca2_rule</span><span class="p">,</span> <span class="n">width2</span><span class="p">,</span> <span class="n">init2</span><span class="p">)</span>
<span class="c1">#ca2.plot(iterations=length2);</span>
<span class="n">strips2</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">110</span><span class="p">,</span> <span class="mi">116</span><span class="p">)]</span>
<span class="n">ca2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">iterations</span><span class="o">=</span><span class="n">length2</span><span class="p">,</span> <span class="n">strips</span><span class="o">=</span><span class="n">strips2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/06_fractals_11_0.png" class="no-scaled-link" src="_images/06_fractals_11_0.png" style="width: 494px; height: 700px;" />
</div>
</div>
<p>We can narrow our cellular automata arrays with the <code class="docutils literal notranslate"><span class="pre">extract_strip</span></code> argument.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ca1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">iterations</span><span class="o">=</span><span class="n">length1</span><span class="p">,</span> <span class="n">strips</span><span class="o">=</span><span class="n">strips1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Guitar&#39;</span><span class="p">,</span> <span class="s1">&#39;Bass&#39;</span><span class="p">],</span> <span class="n">extract_strip</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">ca2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">iterations</span><span class="o">=</span><span class="n">length2</span><span class="p">,</span> <span class="n">strips</span><span class="o">=</span><span class="n">strips2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Drums&quot;</span><span class="p">],</span> <span class="n">extract_strip</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/06_fractals_13_0.png" class="no-scaled-link" src="_images/06_fractals_13_0.png" style="width: 1190px; height: 279px;" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/06_fractals_13_1.png" class="no-scaled-link" src="_images/06_fractals_13_1.png" style="width: 1190px; height: 134px;" />
</div>
</div>
</section>
<section id="Step-3.-Generate-pitches">
<h3>Step 3. Generate pitches<a class="headerlink" href="#Step-3.-Generate-pitches" title="Link to this heading">¶</a></h3>
<p>Until now, we just selected our strips visually. The <code class="docutils literal notranslate"><span class="pre">.generate()</span></code> method creates a sequence of numbers based on the strips, mapped on the <code class="docutils literal notranslate"><span class="pre">values</span></code> argument. We must trigger <code class="docutils literal notranslate"><span class="pre">.generate()</span></code> with arguments <code class="docutils literal notranslate"><span class="pre">iterations</span></code> for the length of the sequence, <code class="docutils literal notranslate"><span class="pre">strips</span></code> as used previously, and <code class="docutils literal notranslate"><span class="pre">values</span></code>, a list of dictionaries used for mapping.</p>
<p>In our case, values are pitches. I used a C-minor scale (even for the drums, but it doesn’t really matter), and durations sum to 8 to cover two 4/4 measures.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">guitar_p_set</span> <span class="o">=</span> <span class="p">[</span><span class="n">dj</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">cde_to_midi</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="s1">&#39;D4&#39;</span><span class="p">,</span> <span class="s1">&#39;Eb4&#39;</span><span class="p">,</span> <span class="s1">&#39;F4&#39;</span><span class="p">,</span> <span class="s1">&#39;G4&#39;</span><span class="p">,</span> <span class="s1">&#39;Ab4&#39;</span><span class="p">,</span> <span class="s1">&#39;Bb4&#39;</span><span class="p">]]</span>
<span class="n">bass_p_set</span> <span class="o">=</span> <span class="p">[</span><span class="n">dj</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">cde_to_midi</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;D3&#39;</span><span class="p">,</span> <span class="s1">&#39;Eb3&#39;</span><span class="p">,</span> <span class="s1">&#39;F3&#39;</span><span class="p">,</span> <span class="s1">&#39;G3&#39;</span><span class="p">,</span> <span class="s1">&#39;Ab3&#39;</span><span class="p">,</span> <span class="s1">&#39;Bb3&#39;</span><span class="p">]]</span>
<span class="n">drum_p_set</span> <span class="o">=</span> <span class="p">[</span><span class="n">dj</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">cde_to_midi</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;G3&#39;</span><span class="p">,</span> <span class="s1">&#39;Ab3&#39;</span><span class="p">,</span> <span class="s1">&#39;Bb3&#39;</span><span class="p">,</span> <span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="s1">&#39;D4&#39;</span><span class="p">,</span> <span class="s1">&#39;Eb4&#39;</span><span class="p">,</span> <span class="s1">&#39;F4&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<p>The values in <code class="docutils literal notranslate"><span class="pre">.generate()</span></code> must be specified in dictionaries.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">guitar_values</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">guitar_p_set</span><span class="p">):</span>
    <span class="n">guitar_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span>

<span class="n">bass_values</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bass_p_set</span><span class="p">):</span>
    <span class="n">bass_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span>

<span class="n">drum_values</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">drum_p_set</span><span class="p">):</span>
    <span class="n">drum_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span>
</pre></div>
</div>
</div>
<p>Our streams of pitches can now be generated.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">guitar_p</span><span class="p">,</span> <span class="n">bass_p</span> <span class="o">=</span> <span class="n">ca1</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">length1</span><span class="p">,</span> <span class="n">strips1</span><span class="p">,</span> <span class="p">[</span><span class="n">guitar_values</span><span class="p">,</span> <span class="n">bass_values</span><span class="p">])</span>
<span class="n">drum_p</span> <span class="o">=</span> <span class="n">ca2</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">length2</span><span class="p">,</span> <span class="n">strips2</span><span class="p">,</span> <span class="p">[</span><span class="n">drum_values</span><span class="p">])</span>
</pre></div>
</div>
</div>
</section>
<section id="Step-4.-Map-pitches-to-notes">
<h3>Step 4. Map pitches to notes<a class="headerlink" href="#Step-4.-Map-pitches-to-notes" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">beatcycle</span></code> function zips cycling durations on the pitches to generate streams of notes with Djalgo’s form (pitch, duration, offset).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">guitar_n</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">rhythm</span><span class="o">.</span><span class="n">beatcycle</span><span class="p">(</span><span class="n">pitches</span><span class="o">=</span><span class="n">guitar_p</span><span class="p">,</span> <span class="n">durations</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
<span class="n">bass_n</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">rhythm</span><span class="o">.</span><span class="n">beatcycle</span><span class="p">(</span><span class="n">pitches</span><span class="o">=</span><span class="n">bass_p</span><span class="p">,</span> <span class="n">durations</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">drum_n</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">rhythm</span><span class="o">.</span><span class="n">beatcycle</span><span class="p">(</span><span class="n">pitches</span><span class="o">=</span><span class="n">drum_p</span><span class="p">,</span> <span class="n">durations</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>To make the bass track sound right, we might preferred to pla ity one note at the time, not chords. We can iterate trhough the pitches and when comes a list, take the first element.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bass_n</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">bass_n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>We glue the tracks together with the insert method so that the are played simultaneously.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">piece_m21</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">convert</span><span class="p">([</span><span class="n">guitar_n</span><span class="p">,</span> <span class="n">bass_n</span><span class="p">,</span> <span class="n">drum_n</span><span class="p">],</span> <span class="s1">&#39;music21&#39;</span><span class="p">)</span>
<span class="n">piece_m21</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">&#39;midi&#39;</span><span class="p">)</span>
<span class="n">piece_m21</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;midi&#39;</span><span class="p">,</span> <span class="s1">&#39;music/ca.mid&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div id="midiPlayerDiv5941"></div>
<link rel="stylesheet" href="https://cuthbertLab.github.io/music21j/css/m21.css">

<script
src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"
></script>

<script>
function midiPlayerDiv5941_play() {
    const rq = require.config({
        paths: {
            'music21': 'https://cuthbertLab.github.io/music21j/releases/music21.debug',
        }
    });
    rq(['music21'], function(music21) {
        mp = new music21.miditools.MidiPlayer();
        mp.addPlayer("#midiPlayerDiv5941");
        mp.base64Load("data:audio/midi;base64,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");
    });
}
if (typeof require === 'undefined') {
    setTimeout(midiPlayerDiv5941_play, 2000);
} else {
    midiPlayerDiv5941_play();
}
</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;music/ca.mid&#39;
</pre></div></div>
</div>
<p>By exporting our piece to a midi file, we can then import it in a DAW for further processing. I imported the file <code class="docutils literal notranslate"><span class="pre">ca.mid</span></code> in a DAW called Waveform, then mapped each track to Komplete start virtual instruments. Both Waveform and Komplete start can be used without cost and are covered by many tutorials online.</p>
<iframe width="100%" height="200" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/1429599889&amp;color=%23ff5500&amp;auto_play=false&amp;hide_related=false&amp;show_comments=true&amp;show_user=true&amp;show_rateateeposts=false&amp;show_teaser=true&amp;visual=true"></iframe><div style="font-size: 10px; color: #cccccc;line-break: anywhere;word-break: normal;overflow: hidden;white-space: nowrap;text-overflow: ellipsis; font-family: Interstate,Lucida Grande,Lucida Sans Unicode,Lucida Sans,Garuda,Verdana,Tahoma,sans-serif;font-weight: 100;"><p>motife · T-Cells vogue</p>
</div><p>Because cellular automata generate repeating patterns, they perform nicely for rhythmic parts. However, they will fall short for melodies.</p>
</section>
</section>
<section id="Mandelbrot">
<h2>Mandelbrot<a class="headerlink" href="#Mandelbrot" title="Link to this heading">¶</a></h2>
<p>You might already have seen the intriguing plot of the Mandelbrot ensemble. Djalgo implements a Mandelbrot fractal generator, which can creatively be used to generate musical patterns based on the fractal data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">djalgo</span> <span class="k">as</span> <span class="nn">dj</span>
<span class="n">dj</span><span class="o">.</span><span class="n">fractal</span><span class="o">.</span><span class="n">Mandelbrot</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/06_fractals_28_0.png" class="no-scaled-link" src="_images/06_fractals_28_0.png" style="width: 618px; height: 623px;" />
</div>
</div>
<p>By zooming the plot, you can find unexplored regions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">ranges</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">((</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)),</span>
    <span class="p">((</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)),</span>
    <span class="p">((</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)),</span>
    <span class="p">((</span><span class="o">-</span><span class="mf">1.145</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.150</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.275</span><span class="p">,</span> <span class="mf">0.280</span><span class="p">))</span>
<span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">((</span><span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="p">),</span> <span class="n">ax</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">ranges</span><span class="p">,</span> <span class="n">axs</span><span class="p">)):</span>
    <span class="n">mandelbrot</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">fractal</span><span class="o">.</span><span class="n">Mandelbrot</span><span class="p">(</span><span class="n">dimensions</span><span class="o">=</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">),</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="o">=</span><span class="n">y_range</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ranges</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">mandelbrot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">zoom_rect</span><span class="o">=</span><span class="n">ranges</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mandelbrot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/06_fractals_30_0.png" class="no-scaled-link" src="_images/06_fractals_30_0.png" style="width: 874px; height: 854px;" />
</div>
</div>
<p>By scanning the Mandelbrot matrix to subtract the numbers (horizontally, vertically or diagonally), you can generate a sequence of integers. The smaller value used for lenght pixelizes the last Mandelbrot plot to create a smaller matrix, since we need fewer values for a musical sequence.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span> <span class="o">=</span> <span class="n">ranges</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="n">length</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">mandelbrot</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">fractal</span><span class="o">.</span><span class="n">Mandelbrot</span><span class="p">(</span><span class="n">dimensions</span><span class="o">=</span><span class="n">length</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">x_range</span><span class="o">=</span><span class="n">x_range</span><span class="p">,</span> <span class="n">y_range</span><span class="o">=</span><span class="n">y_range</span><span class="p">)</span>
<span class="n">mandelbrot_integers</span> <span class="o">=</span> <span class="n">mandelbrot</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;diagonal-increasing&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="c1"># heatmap</span>
<span class="n">mandelbrot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">show_numbers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># increasing diagonal channel</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">length</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="o">-</span><span class="mf">1.5</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="o">-</span><span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">length</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="c1">#numbers</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">),</span> <span class="n">mandelbrot_integers</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">);</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mandelbrot_integers</span><span class="p">):</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">m</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/06_fractals_32_0.png" class="no-scaled-link" src="_images/06_fractals_32_0.png" style="width: 1630px; height: 700px;" />
</div>
</div>
<p>These numbers can be set as midi pitches, index on scales, etc. If you need a scale, make sure the indexes are included in the scale. You can scale them to range between index 0 and index 20.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">g_major</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">harmony</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="n">tonic</span><span class="o">=</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="n">scale_type</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">generate</span><span class="p">()[</span><span class="mi">32</span><span class="p">:</span><span class="mi">53</span><span class="p">]</span>
<span class="n">mandelbrot_index</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dj</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">scale_list</span><span class="p">(</span><span class="n">mandelbrot_integers</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">)]</span>
<span class="n">mandelbrot_p</span> <span class="o">=</span> <span class="p">[</span><span class="n">g_major</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mandelbrot_index</span><span class="p">]</span>
<span class="n">mandelbrot_n</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">rhythm</span><span class="o">.</span><span class="n">beatcycle</span><span class="p">(</span><span class="n">pitches</span><span class="o">=</span><span class="n">mandelbrot_p</span><span class="p">,</span> <span class="n">durations</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">mandelbrot_m21</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">mandelbrot_n</span><span class="p">,</span> <span class="s1">&#39;music21&#39;</span><span class="p">)</span>
<span class="n">mandelbrot_m21</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">mandelbrot_m21</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">&#39;midi&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/06_fractals_34_0.png" class="no-scaled-link" src="_images/06_fractals_34_0.png" style="width: 697px; height: 58px;" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div id="midiPlayerDiv476"></div>
<link rel="stylesheet" href="https://cuthbertLab.github.io/music21j/css/m21.css">

<script
src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"
></script>

<script>
function midiPlayerDiv476_play() {
    const rq = require.config({
        paths: {
            'music21': 'https://cuthbertLab.github.io/music21j/releases/music21.debug',
        }
    });
    rq(['music21'], function(music21) {
        mp = new music21.miditools.MidiPlayer();
        mp.addPlayer("#midiPlayerDiv476");
        mp.base64Load("data:audio/midi;base64,TVRoZAAAAAYAAQACJ2BNVHJrAAAAFAD/UQMHoSAA/1gEBAIYCM5g/y8ATVRyawAAAMYA/wMAAOAAQM5gkDxapzCAPAAAkDtapzCAOwAAkDxazmCAPAAAkEBagZ1AgEAAAJBDWs5ggEMAAJA+WqcwgD4AAJBCWqcwgEIAAJBFWs5ggEUAAJBFWoGdQIBFAACQSFrOYIBIAACQTlqnMIBOAACQRVqnMIBFAACQQlrOYIBCAACQPFqBnUCAPAAAkDlazmCAOQAAkDlapzCAOQAAkDlapzCAOQAAkDdazmCANwAAkDdagZ1AgDcAAJA3Ws5ggDcAzmD/LwA=");
    });
}
if (typeof require === 'undefined') {
    setTimeout(midiPlayerDiv476_play, 2000);
} else {
    midiPlayerDiv476_play();
}
</script></div>
</div>
</section>
<section id="Logistic-map">
<h2>Logistic map<a class="headerlink" href="#Logistic-map" title="Link to this heading">¶</a></h2>
<p>The logistic map comes from the logistic growth equation, which in turn comes from the concept population growth. Disregarding limitations from the environment, a population <span class="math notranslate nohighlight">\(🐇\)</span> of a reproducing species will grow at a certain <span class="math notranslate nohighlight">\(r\)</span> rate.</p>
<div class="math notranslate nohighlight">
\[🐇_{t+1} = r \times 🐇_t\]</div>
<p>That means that population <span class="math notranslate nohighlight">\(x\)</span> at the next step depends on population <span class="math notranslate nohighlight">\(x\)</span> at the current step times a growth rate, expressed in proprotion of the population per step.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">growth</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">r</span> <span class="o">*</span> <span class="n">x</span> <span class="c1"># simple exponential growth</span>

<span class="n">initial_population</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">population</span> <span class="o">=</span> <span class="p">[</span><span class="n">initial_population</span><span class="p">]</span>
<span class="n">generations</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">growth_rate</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># population doubles each generation</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">generations</span><span class="p">):</span>
    <span class="n">population</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">growth</span><span class="p">(</span><span class="n">population</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">growth_rate</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">generations</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">population</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/06_fractals_36_0.png" class="no-scaled-link" src="_images/06_fractals_36_0.png" style="width: 578px; height: 413px;" />
</div>
</div>
<p>The growth is exponential. The more the population, the more it reproduces. But populations never grows to infinite. There are always limits to population growth. We might want to decrease the growth rate over time. Or, a better way to think of it would be to decrease the growth rate according to the population: the more the population, the less the growth rate. Let’s call it the limit of the environment <span class="math notranslate nohighlight">\(limit\)</span>. This is where the logistic equation is useful.</p>
<div class="math notranslate nohighlight">
\[🐇_{t+1} = r \times 🐇_t \times \frac{(limit - 🐇_t)}{limit}\]</div>
<p>When <span class="math notranslate nohighlight">\(🐇_t\)</span> comes close to the <span class="math notranslate nohighlight">\(limit\)</span>, the term <span class="math notranslate nohighlight">\(\frac{(limit - 🐇_t)}{limit}\)</span> comes close to zero.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">logistic_growth</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">limit</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">r</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">limit</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">limit</span> <span class="c1"># logistic growth</span>

<span class="n">initial_population</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">population</span> <span class="o">=</span> <span class="p">[</span><span class="n">initial_population</span><span class="p">]</span>
<span class="n">generations</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">growth_rate</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">limit</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">generations</span><span class="p">):</span>
    <span class="n">population</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">logistic_growth</span><span class="p">(</span><span class="n">population</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">growth_rate</span><span class="p">,</span> <span class="n">limit</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">generations</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">population</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Logistic Growth, rate = </span><span class="si">{</span><span class="n">growth_rate</span><span class="si">}</span><span class="s1">, limit = </span><span class="si">{</span><span class="n">limit</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/06_fractals_38_0.png" class="no-scaled-link" src="_images/06_fractals_38_0.png" style="width: 561px; height: 434px;" />
</div>
</div>
<p>You might have remarked that the population never reaches 5000, but only half of it. Thats because the growth rate is decreased so much that population can’t reach the maximum allowed. Let’s see what happens with different growth rates.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">growth_rates</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">3.25</span><span class="p">]</span>
<span class="n">initial_population</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">limit</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">generations</span> <span class="o">=</span> <span class="mi">50</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">growth_rates</span><span class="p">:</span>
    <span class="n">population</span> <span class="o">=</span> <span class="p">[</span><span class="n">initial_population</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">generations</span><span class="p">):</span>
        <span class="n">population</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">logistic_growth</span><span class="p">(</span><span class="n">population</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">r</span><span class="p">,</span> <span class="n">limit</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">generations</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">population</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;rate = </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Logistic Growth&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/06_fractals_40_0.png" class="no-scaled-link" src="_images/06_fractals_40_0.png" style="width: 561px; height: 434px;" />
</div>
</div>
<p>When growth rate increases, an oscillating convergence to a stabilized value occurs, and this value depends on the growth rate.. If we focus our interest on this stabilized value depending on growth rates, we get a very intriguing pattern.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[98]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lm</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">fractals</span><span class="o">.</span><span class="n">LogisticMap</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">last_n</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">lm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/06_fractals_42_0.png" class="no-scaled-link" src="_images/06_fractals_42_0.png" style="width: 547px; height: 376px;" />
</div>
</div>
<p>An explaination of this behaviour can be find on the Veritasium YouTube channel.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/ovJcsL7vyrk?si=EQoJddVSfTCDMeox" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe><p>The logistic map can be used to create notes. Here, we lower the resolution to create a list of pitches.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[112]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">length</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">lm</span> <span class="o">=</span> <span class="n">LogisticMap</span><span class="p">(</span><span class="n">rates</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">length</span><span class="p">),</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">last_n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">lm_values</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">),</span> <span class="n">lm_values</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/06_fractals_45_0.png" class="no-scaled-link" src="_images/06_fractals_45_0.png" style="width: 547px; height: 413px;" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[113]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lm_index</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dj</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">scale_list</span><span class="p">(</span><span class="n">lm_values</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">)]</span>
<span class="n">lm_p</span> <span class="o">=</span> <span class="p">[</span><span class="n">g_major</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">lm_index</span><span class="p">]</span>
<span class="n">lm_n</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">rhythm</span><span class="o">.</span><span class="n">beatcycle</span><span class="p">(</span><span class="n">pitches</span><span class="o">=</span><span class="n">lm_p</span><span class="p">,</span> <span class="n">durations</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">lm_m21</span> <span class="o">=</span> <span class="n">dj</span><span class="o">.</span><span class="n">conversion</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">lm_n</span><span class="p">,</span> <span class="s1">&#39;music21&#39;</span><span class="p">)</span>
<span class="n">lm_m21</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">lm_m21</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">&#39;midi&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/06_fractals_46_0.png" class="no-scaled-link" src="_images/06_fractals_46_0.png" style="width: 697px; height: 58px;" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div id="midiPlayerDiv948"></div>
<link rel="stylesheet" href="https://cuthbertLab.github.io/music21j/css/m21.css">

<script
src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"
></script>

<script>
function midiPlayerDiv948_play() {
    const rq = require.config({
        paths: {
            'music21': 'https://cuthbertLab.github.io/music21j/releases/music21.debug',
        }
    });
    rq(['music21'], function(music21) {
        mp = new music21.miditools.MidiPlayer();
        mp.addPlayer("#midiPlayerDiv948");
        mp.base64Load("data:audio/midi;base64,TVRoZAAAAAYAAQACJ2BNVHJrAAAAFAD/UQMHoSAA/1gEBAIYCM5g/y8ATVRyawAAAMYA/wMAAOAAQM5gkEpapzCASgAAkEpapzCASgAAkEpazmCASgAAkEpagZ1AgEoAAJBMWs5ggEwAAJBKWqcwgEoAAJBIWqcwgEgAAJA+Ws5ggD4AAJBMWoGdQIBMAACQQ1rOYIBDAACQSlqnMIBKAACQSlqnMIBKAACQSFrOYIBIAACQO1qBnUCAOwAAkExazmCATAAAkE5apzCATgAAkENapzCAQwAAkExazmCATAAAkExagZ1AgEwAAJA3Ws5ggDcAzmD/LwA=");
    });
}
if (typeof require === 'undefined') {
    setTimeout(midiPlayerDiv948_play, 2000);
} else {
    midiPlayerDiv948_play();
}
</script></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="01_getting-started.html">1. Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_harmony.html">2. Harmonies</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_loops.html">3. Loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_minimalism.html">4. Minimalism</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_walks.html">5. Walks</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">6. Fractals</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_genetic.html">7. Genetic algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script><div>
<br/>
<a href="https://www.buymeacoffee.com/essicolo">☕ Buy me a coffee</a>
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Essi Parent.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/06_fractals.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>